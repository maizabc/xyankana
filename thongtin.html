<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>ThÃ´ng tin tÃ i khoáº£n</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container py-5">
  <h2 class="mb-4">ThÃ´ng tin tÃ i khoáº£n</h2>

  <!-- Navigation -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <a href="index.html" class="btn btn-outline-dark me-2">Trang chá»§</a>
      <a href="thongtin.html" class="btn btn-outline-info me-2">ThÃ´ng tin</a>
      <a href="naptien.html" class="btn btn-outline-warning ms-2">Náº¡p tiá»n</a>
      <a href="login.html" id="loginBtn" class="btn btn-outline-primary">ÄÄƒng nháº­p</a>
      <a href="register.html" id="registerBtn" class="btn btn-outline-success ms-2">ÄÄƒng kÃ½</a>
      <span id="balanceDisplay" class="ms-3 fw-bold text-success"></span>
    </div>
  </div>

  <!-- TÃ i khoáº£n -->
  <p><strong>TÃ i khoáº£n Ä‘Äƒng nháº­p:</strong> <span id="username" class="text-primary fw-bold"></span></p>

  <!-- Äá»•i máº­t kháº©u -->
  <div class="mb-4">
    <h5>Äá»•i máº­t kháº©u</h5>
    <input type="password" id="newPass" class="form-control" placeholder="Nháº­p máº­t kháº©u má»›i">
    <button onclick="changePassword()" class="btn btn-warning mt-2">LÆ°u máº­t kháº©u</button>
  </div>

  <!-- ACC Ä‘Ã£ mua -->
  <div>
    <h5 class="mb-2">TÃ i khoáº£n game Ä‘Ã£ mua:</h5>
    <ul id="purchasedList" class="list-group"></ul>
  </div>

  <!-- NÃºt Ä‘Äƒng xuáº¥t -->
  <div class="text-center mt-4">
    <button class="btn btn-outline-danger" onclick="logout()">ğŸ”“ ÄÄƒng xuáº¥t</button>
  </div>
</div>

<!-- Script -->
<script>
  const username = localStorage.getItem("user");
  const balance = parseInt(localStorage.getItem("balance") || "0");

  // Kiá»ƒm tra Ä‘Äƒng nháº­p
  if (!username) {
    alert("Vui lÃ²ng Ä‘Äƒng nháº­p!");
    window.location.href = "login.html";
  }

  // Hiá»ƒn thá»‹ tÃªn ngÆ°á»i dÃ¹ng vÃ  sá»‘ dÆ°
  document.getElementById("username").innerText = username || "ChÆ°a Ä‘Äƒng nháº­p";
  document.getElementById("balanceDisplay").innerText = username ? `Sá»‘ dÆ°: ${balance.toLocaleString()}Ä‘` : "";

  // áº¨n Ä‘Äƒng nháº­p / Ä‘Äƒng kÃ½ náº¿u Ä‘Ã£ Ä‘Äƒng nháº­p
  if (username) {
    const loginBtn = document.getElementById("loginBtn");
    const registerBtn = document.getElementById("registerBtn");
    if (loginBtn) loginBtn.style.display = "none";
    if (registerBtn) registerBtn.style.display = "none";
  }

  // Äá»•i máº­t kháº©u riÃªng cho user
  function changePassword() {
    const newPass = document.getElementById("newPass").value;
    if (!newPass) return alert("Vui lÃ²ng nháº­p máº­t kháº©u má»›i!");
    localStorage.setItem("pass_" + username, newPass);
    alert("âœ… Äá»•i máº­t kháº©u thÃ nh cÃ´ng!");
  }

  // Hiá»ƒn thá»‹ danh sÃ¡ch acc Ä‘Ã£ mua cá»§a user hiá»‡n táº¡i
  const purchased = JSON.parse(localStorage.getItem("purchased_" + username) || "[]");
  const list = document.getElementById("purchasedList");

  if (purchased.length === 0) {
    list.innerHTML = "<li class='list-group-item'>Báº¡n chÆ°a mua tÃ i khoáº£n nÃ o.</li>";
  } else {
    purchased.forEach(acc => {
      const li = document.createElement("li");
      li.className = "list-group-item";
      li.innerText = `${acc.name} | TÃ i khoáº£n: ${acc.username} | Máº­t kháº©u: ${acc.password}`;
      list.appendChild(li);
    });
  }

  // ÄÄƒng xuáº¥t
  function logout() {
    localStorage.removeItem("user");
    alert("ğŸ‘‹ Báº¡n Ä‘Ã£ Ä‘Äƒng xuáº¥t!");
    window.location.href = "index.html";
  }
</script>
</body>
</html>
